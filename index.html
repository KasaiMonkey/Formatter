<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Masaya's Code2HTML - V1.0a</title>
    <link rel="stylesheet" href="https://kasaimonkey.github.io/Formatter/MasayaStyle.css">
    <link rel="stylesheet" href="https://kasaimonkey.github.io/Formatter/MasayaLineStyle.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
        }
        #inputField {
            width: 100%;
            height: 100px;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
        }
        #codeBlock {
            background-color: #282c34;
            border-radius: 5px;
            padding: 15px;
            overflow: auto;
            margin-top: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        pre {
            margin: 0;
            padding: 0;
        }
        .hljs {
            color: #f8f8f2;
            background: #282c34;
        }
        button {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            font-size: 16px;
        }
    </style>
</head>
<body>

<h1>Masaya's Code2HTML - V1.0a</h1>

<!-- Input Field -->
<textarea id="inputField" placeholder="Type or paste your C# code here..."></textarea>

<!-- Copy Button -->
<button id="copyButton">Copy as HTML</button>

<!-- Code Display -->
<div id="codeBlock">
    <pre><code class="language-C#">Add Code...</code></pre>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
    const inputField = document.getElementById('inputField');
    const codeBlock = document.querySelector('#codeBlock code');
    const copyButton = document.getElementById('copyButton');

    // Function to reset and highlight the code block
    function resetCodeBlock(code) {
        // Clear the code block and add a new code element
        const pre = document.createElement('pre');
        const newCode = document.createElement('code');
        newCode.className = 'language-C#'; // Set the language
        newCode.textContent = code;

        pre.appendChild(newCode);
        codeBlock.innerHTML = ''; // Clear existing code block
        codeBlock.appendChild(pre); // Add the new code element

        // Highlight the new code
        hljs.highlightElement(newCode);
    }

    // Initial rendering with "Add Code"
    resetCodeBlock('Add Code...');

    // Event listener for input changes
    inputField.addEventListener('input', function() {
        const codeValue = inputField.value || 'Add code...';
        resetCodeBlock(codeValue); // Reset and highlight new code
    });

    // Function to fetch URLs and copy to clipboard
    async function fetchAndCopy() {
        const startlineUrl = 'https://kasaimonkey.github.io/Formatter/start-lines.txt';
        const endlineUrl = 'https://kasaimonkey.github.io/Formatter/end-lines.txt';

        try {
            const [startlineResponse, endlineResponse] = await Promise.all([
                fetch(startlineUrl),
                fetch(endlineUrl)
            ]);

            const startline = await startlineResponse.text();
            const endline = await endlineResponse.text();
            const inputText = inputField.value;

            // Combine the strings
            const finalText = `${startline}${inputText}\n${endline}`;

            // Copy to clipboard
            await navigator.clipboard.writeText(finalText);
            alert('Copied to clipboard!');
        } catch (error) {
            console.error('Error fetching the lines:', error);
            alert('Failed to copy text. Please try again.');
        }
    }

    // Add event listener to the copy button
    copyButton.addEventListener('click', fetchAndCopy);
</script>

</body>
</html>
